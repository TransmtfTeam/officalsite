{{template "base" .}}

{{define "content"}}
<div class="panel-wrap">
  <aside class="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-title">ç®¡ç†å¯¼èˆª</div>
      {{if .CurrentUser.IsAdmin}}
      <a class="sidebar-link" href="/admin">æ¦‚è§ˆ</a>
      <a class="sidebar-link" href="/admin/users">ç”¨æˆ·</a>
      {{end}}
      <a class="sidebar-link active" href="/admin/groups">åˆ†ç»„</a>
      <a class="sidebar-link" href="/admin/clients">åº”ç”¨</a>
      {{if .CurrentUser.IsAdmin}}
      <a class="sidebar-link" href="/admin/providers">ç™»å½•æ–¹å¼</a>
      <a class="sidebar-link" href="/admin/roles">è§’è‰²</a>
      <a class="sidebar-link" href="/admin/announcements">å…¬å‘Š</a>
      <a class="sidebar-link" href="/admin/settings">è®¾ç½®</a>
      {{end}}
    </div>
    <div class="sidebar-section">
      <div class="sidebar-title">å¿«é€Ÿå…¥å£</div>
      <a class="sidebar-link" href="/">è¿”å›é¦–é¡µ</a>
      <a class="sidebar-link" href="/profile">ä¸ªäººèµ„æ–™</a>
    </div>
  </aside>

  <main class="panel-content">
    <h1 class="panel-title">åˆ†ç»„ç®¡ç†</h1>
    <p class="panel-sub">åˆ›å»ºè‡ªå®šä¹‰åˆ†ç»„å¹¶ç®¡ç†æˆå‘˜ã€‚å†…ç½®åˆ†ç»„ <code>admin</code>ã€<code>member</code> ç”±è§’è‰²è‡ªåŠ¨å†³å®šï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†ã€‚</p>

    {{if .Flash}}
    <div class="flash {{if .IsError}}flash-err{{else}}flash-ok{{end}}">{{.Flash}}</div>
    {{end}}

    {{/* â”€â”€ å†…ç½®åˆ†ç»„è¯´æ˜ â”€â”€ */}}
    <div class="detail-section" style="margin-bottom:1.5rem">
      <div class="detail-section-title">å†…ç½®åˆ†ç»„ï¼ˆç³»ç»Ÿè‡ªåŠ¨ï¼‰</div>
      <div class="detail-row">
        <div class="detail-key"><span class="role-badge role-admin">admin</span></div>
        <div class="detail-val" style="font-size:.88rem;color:var(--text2)">æ‹¥æœ‰ admin è§’è‰²çš„æ‰€æœ‰ç”¨æˆ·</div>
      </div>
      <div class="detail-row">
        <div class="detail-key"><span class="role-badge role-member">member</span></div>
        <div class="detail-val" style="font-size:.88rem;color:var(--text2)">æ‹¥æœ‰ member æˆ– admin è§’è‰²çš„æ‰€æœ‰ç”¨æˆ·</div>
      </div>
    </div>

    {{/* â”€â”€ æ–°å»ºåˆ†ç»„ â”€â”€ */}}
    <div class="form-panel">
      <p class="form-panel-title">æ–°å»ºè‡ªå®šä¹‰åˆ†ç»„</p>
      <form method="POST" action="/admin/groups">
        <input type="hidden" name="csrf_token" value="{{$.CSRFToken}}">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">åˆ†ç»„æ ‡è¯†ï¼ˆè‹±æ–‡å°å†™ï¼Œå¦‚ dev-teamï¼‰</label>
            <input class="form-control" type="text" name="name" placeholder="my-group"
              pattern="[a-z0-9\-_]+" title="ä»…å…è®¸å°å†™å­—æ¯ã€æ•°å­—ã€è¿å­—ç¬¦å’Œä¸‹åˆ’çº¿" required>
          </div>
          <div class="form-group">
            <label class="form-label">æ˜¾ç¤ºåç§°</label>
            <input class="form-control" type="text" name="label" placeholder="æˆ‘çš„åˆ†ç»„">
          </div>
        </div>
        <button class="btn btn-primary btn-sm" type="submit">åˆ›å»ºåˆ†ç»„</button>
      </form>
    </div>

    {{/* â”€â”€ åˆ†ç»„åˆ—è¡¨ â”€â”€ */}}
    <div class="card">
      <table class="data-table">
        <thead>
          <tr>
            <th>åˆ†ç»„æ ‡è¯†</th>
            <th>æ˜¾ç¤ºåç§°</th>
            <th>åˆ›å»ºæ—¶é—´</th>
            <th>æ“ä½œ</th>
          </tr>
        </thead>
        <tbody>
          {{range .Data}}
          <tr>
            <td><a href="/admin/groups/{{.ID}}" style="font-weight:500;font-family:monospace">{{.Name}}</a></td>
            <td>{{if .Label}}{{.Label}}{{else}}<span style="color:var(--text2)">â€”</span>{{end}}</td>
            <td>{{.CreatedAt.Format "2006-01-02"}}</td>
            <td>
              <a class="btn btn-ghost btn-sm" href="/admin/groups/{{.ID}}">ç®¡ç†æˆå‘˜</a>
              <form method="POST" action="/admin/groups/{{.ID}}/delete" style="display:inline-block;margin-left:.3rem">
                <input type="hidden" name="csrf_token" value="{{$.CSRFToken}}">
                <button class="btn btn-danger btn-sm" type="submit"
                  data-confirm="ç¡®è®¤åˆ é™¤æ­¤åˆ†ç»„å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚" data-confirm-title="åˆ é™¤åˆ†ç»„" data-confirm-icon="ğŸ—‘ï¸">åˆ é™¤</button>
              </form>
            </td>
          </tr>
          {{else}}
          <tr><td colspan="4" style="color:var(--text2);text-align:center;padding:2rem">æš‚æ— è‡ªå®šä¹‰åˆ†ç»„</td></tr>
          {{end}}
        </tbody>
      </table>
    </div>
  </main>
</div>
{{end}}
