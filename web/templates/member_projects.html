{{template "base" .}}

{{define "content"}}
<div class="panel-wrap">
  <aside class="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-title">æˆå‘˜å¯¼èˆª</div>
      <a class="sidebar-link active" href="/member/projects">é¡¹ç›®ç®¡ç†</a>
      <a class="sidebar-link" href="/member/links">å‹æƒ…é“¾æ¥</a>
      {{if .CurrentUser}}{{if .CurrentUser.IsAdmin}}<a class="sidebar-link" href="/admin">ç®¡ç†åå°</a>{{end}}{{end}}
    </div>
    <div class="sidebar-section">
      <div class="sidebar-title">å¿«é€Ÿå…¥å£</div>
      <a class="sidebar-link" href="/">è¿”å›é¦–é¡µ</a>
      <a class="sidebar-link" href="/profile">ä¸ªäººèµ„æ–™</a>
    </div>
  </aside>

  <main class="panel-content">
    <h1 class="panel-title">é¡¹ç›®ç®¡ç†</h1>
    <p class="panel-sub">åˆ›å»ºå’Œç»´æŠ¤é¦–é¡µå±•ç¤ºçš„å›¢é˜Ÿé¡¹ç›®ã€‚</p>

    {{if .Flash}}
    <div class="flash {{if .IsError}}flash-err{{else}}flash-ok{{end}}">{{.Flash}}</div>
    {{end}}

    <div class="form-panel">
      <p class="form-panel-title">æ–°å¢é¡¹ç›®</p>
      <form method="POST" action="/member/projects">
        <input type="hidden" name="csrf_token" value="{{$.CSRFToken}}">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Slug</label>
            <input class="form-control" type="text" name="slug" placeholder="my-project" required>
          </div>
          <div class="form-group">
            <label class="form-label">ä¸­æ–‡å</label>
            <input class="form-control" type="text" name="name_zh">
          </div>
          <div class="form-group">
            <label class="form-label">è‹±æ–‡å</label>
            <input class="form-control" type="text" name="name_en">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">ä¸­æ–‡ç®€ä»‹</label>
            <textarea class="form-control" name="desc_zh" rows="2"></textarea>
          </div>
          <div class="form-group">
            <label class="form-label">è‹±æ–‡ç®€ä»‹</label>
            <textarea class="form-control" name="desc_en" rows="2"></textarea>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">çŠ¶æ€</label>
            <select class="form-control" name="status">
              <option value="active">active</option>
              <option value="planning">planning</option>
              <option value="completed">completed</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">é¡¹ç›®é“¾æ¥ï¼ˆå¯é€‰ï¼‰</label>
            <input class="form-control" type="url" name="url" placeholder="https://...">
          </div>
          <div class="form-group">
            <label class="form-label">Tags(JSON)</label>
            <input class="form-control" type="text" name="tags" placeholder='["Go","OIDC"]'>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">æ’åºå€¼</label>
            <input class="form-control" type="number" name="sort_order" value="0">
          </div>
          <div class="form-group">
            <label class="form-label">æ˜¯å¦ç½®é¡¶</label>
            <select class="form-control" name="featured">
              <option value="0">å¦</option>
              <option value="1">æ˜¯</option>
            </select>
          </div>
        </div>
        <button class="btn btn-primary btn-sm" type="submit">åˆ›å»ºé¡¹ç›®</button>
      </form>
    </div>

    <div class="card">
      <table class="data-table">
        <thead>
          <tr>
            <th>é¡¹ç›®</th>
            <th>çŠ¶æ€</th>
            <th>ç½®é¡¶</th>
            <th>æ“ä½œ</th>
          </tr>
        </thead>
        <tbody>
          {{range .Data}}
          <tr>
            <td>
              <strong>{{if .NameZH}}{{.NameZH}}{{else}}{{.NameEN}}{{end}}</strong>
              {{if .URL}}<br><a href="{{.URL}}" target="_blank" style="font-size:.8rem">{{.URL}}</a>{{end}}
            </td>
            <td><span class="proj-status proj-status-{{.Status}}">{{.Status}}</span></td>
            <td>{{if .Featured}}æ˜¯{{else}}å¦{{end}}</td>
            <td>
              <a class="btn btn-ghost btn-sm" href="/member/projects/{{.ID}}/edit">ç¼–è¾‘</a>
              <form method="POST" action="/member/projects/{{.ID}}/delete" style="display:inline-block;margin-left:.4rem">
                <input type="hidden" name="csrf_token" value="{{$.CSRFToken}}">
                <button class="btn btn-danger btn-sm" type="submit"
                  data-confirm="ç¡®è®¤åˆ é™¤æ­¤é¡¹ç›®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚"
                  data-confirm-title="åˆ é™¤é¡¹ç›®" data-confirm-icon="ğŸ—‘ï¸">åˆ é™¤</button>
              </form>
            </td>
          </tr>
          {{else}}
          <tr><td colspan="4" style="color:#666;text-align:center;padding:2rem">æš‚æ— é¡¹ç›®</td></tr>
          {{end}}
        </tbody>
      </table>
    </div>
  </main>
</div>
{{end}}
