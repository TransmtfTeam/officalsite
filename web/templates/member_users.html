{{template "base" .}}

{{define "content"}}
<div class="panel-wrap">
  <aside class="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-title">成员导航</div>
      <a class="sidebar-link" href="/member/projects">项目管理</a>
      <a class="sidebar-link" href="/member/links">友情链接</a>
      <a class="sidebar-link active" href="/member/users">用户管理</a>
      {{if .CurrentUser}}{{if .CurrentUser.IsAdmin}}<a class="sidebar-link" href="/admin">管理后台</a>{{end}}{{end}}
    </div>
    <div class="sidebar-section">
      <div class="sidebar-title">快速入口</div>
      <a class="sidebar-link" href="/">返回首页</a>
      <a class="sidebar-link" href="/profile">个人资料</a>
    </div>
  </aside>

  <main class="panel-content">
    <h1 class="panel-title">用户列表</h1>
    <p class="panel-sub">查看所有用户信息，可验证邮箱和启停账户。</p>

    {{if .Flash}}
    <div class="flash {{if .IsError}}flash-err{{else}}flash-ok{{end}}">{{.Flash}}</div>
    {{end}}

    <div class="card">
      <table class="data-table">
        <thead>
          <tr>
            <th>用户</th>
            <th>邮箱</th>
            <th>角色</th>
            <th>状态</th>
            <th>邮箱验证</th>
            <th>注册时间</th>
            <th>操作</th>
          </tr>
        </thead>
        <tbody>
          {{range .Data}}
          <tr>
            <td>
              <a href="/member/users/{{.ID}}" style="font-weight:500">{{.DisplayName}}</a>
            </td>
            <td style="font-size:.85rem">{{.Email}}</td>
            <td style="font-size:.85rem">{{.RoleLabel}}</td>
            <td>
              {{if .Active}}<span class="proj-tag" style="background:#dcfce7;color:#166534">正常</span>
              {{else}}<span class="proj-tag" style="background:#fee2e2;color:#991b1b">停用</span>{{end}}
            </td>
            <td>
              {{if .EmailVerified}}<span style="color:#166534;font-size:.85rem">✓ 已验证</span>
              {{else}}<span style="color:#991b1b;font-size:.85rem">✗ 未验证</span>{{end}}
            </td>
            <td style="font-size:.82rem">{{.CreatedAt.Format "2006-01-02"}}</td>
            <td>
              <a class="btn btn-ghost btn-sm" href="/member/users/{{.ID}}">详情</a>
            </td>
          </tr>
          {{else}}
          <tr><td colspan="7" style="color:var(--text2);text-align:center;padding:2rem">暂无用户</td></tr>
          {{end}}
        </tbody>
      </table>
    </div>
  </main>
</div>
{{end}}
